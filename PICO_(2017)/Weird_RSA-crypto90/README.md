## Weird_RSA [CRYPTO 90]

>We recovered some data. It was labeled as RSA, but what in the world are "dq" and "dp"? Can you decrypt the ciphertext for us?

* [RSA.txt](RSA.txt)

### EN / [PL](#rozwiązanie)

### Solution:

In the file we get two values `dp` and `dq`, among other things.

They are used to optimize RSA calculations using the `Chinese Remainder Theorem` algorithm.

Links to this topic:

http://crypto.stackexchange.com/questions/19413/what-are-dp-and-dq-in-encryption-by-rsa-in-c
http://www.di-mgt.com.au/crt_rsa.html

With `dp` and `p` you can find `e` and further decrypt the message.

Whole script:

```python
import libnum

c = 95272795986475189505518980251137003509292621140166383887854853863720692420204142448424074834657149326853553097626486371206617513769930277580823116437975487148956107509247564965652417450550680181691869432067892028368985007229633943149091684419834136214793476910417359537696632874045272326665036717324623992885
p = 11387480584909854985125335848240384226653929942757756384489381242206157197986555243995335158328781970310603060671486688856263776452654268043936036556215243
q = 12972222875218086547425818961477257915105515705982283726851833508079600460542479267972050216838604649742870515200462359007315431848784163790312424462439629
dp = 8191957726161111880866028229950166742224147653136894248088678244548815086744810656765529876284622829884409590596114090872889522887052772791407131880103961
dq = 3570695757580148093370242608506191464756425954703930236924583065811730548932270595568088372441809535917032142349986828862994856575730078580414026791444659

n = p * q

e = libnum.modular.invmod(dp, p-1)

phi = (p - 1) * (q - 1)
d = libnum.modular.invmod(e, phi)


print libnum.n2s(pow(c, d, n))
```

Flag:

```
Theres_more_than_one_way_to_RSA
```

### [EN](#solution) / PL

### Rozwiązanie:

W pliku dostajemy między innymi dwie wartości `dp` i `dq`.

Są one używane do optymalizacji obliczeń RSA z użyciem algorytmu `Chinese Remainder Theorem`.

Linki na ten temat:

http://crypto.stackexchange.com/questions/19413/what-are-dp-and-dq-in-encryption-by-rsa-in-c
http://www.di-mgt.com.au/crt_rsa.html

Mając `dp` i `p` można znaleźć `e` i dalej odszyfrować wiadomość.

Cały skrypt:

```python
import libnum

c = 95272795986475189505518980251137003509292621140166383887854853863720692420204142448424074834657149326853553097626486371206617513769930277580823116437975487148956107509247564965652417450550680181691869432067892028368985007229633943149091684419834136214793476910417359537696632874045272326665036717324623992885
p = 11387480584909854985125335848240384226653929942757756384489381242206157197986555243995335158328781970310603060671486688856263776452654268043936036556215243
q = 12972222875218086547425818961477257915105515705982283726851833508079600460542479267972050216838604649742870515200462359007315431848784163790312424462439629
dp = 8191957726161111880866028229950166742224147653136894248088678244548815086744810656765529876284622829884409590596114090872889522887052772791407131880103961
dq = 3570695757580148093370242608506191464756425954703930236924583065811730548932270595568088372441809535917032142349986828862994856575730078580414026791444659

n = p * q

e = libnum.modular.invmod(dp, p-1)

phi = (p - 1) * (q - 1)
d = libnum.modular.invmod(e, phi)


print libnum.n2s(pow(c, d, n))
```

Flaga:

```
Theres_more_than_one_way_to_RSA
```
